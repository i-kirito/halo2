import{d as m,s,_ as T,U as y,I as _}from"../main.min.js";import"../assets/_commonjsHelpers-042e6b4d.js";var C=Object.defineProperty,w=Object.getOwnPropertyDescriptor,p=(f,o,i,t)=>{for(var e=t>1?void 0:t?w(o,i):o,n=f.length-1,r;n>=0;n--)(r=f[n])&&(e=(t?r(o,i,e):r(e))||e);return t&&e&&C(o,i,e),e};class u{autoCalculateSubmenuPosition(){const o=s.getThemeConfig("post","reward",Array);if(!o||o.length===0)return;const i=document.querySelector(".reward-open");if(!i)return;const t=i.querySelector(".reward-main");if(!t)return;const e=i.offsetWidth;t.style.visibility="hidden",t.style.display="block";const n=t.offsetWidth;console.log(e,n),t.style.display="none",t.style.visibility="visible";const r=e/2-n/2;t.style.left=`${r}px`}registerOriginalPostCopy(){var i;const o=document.querySelector(".entry-content");o&&(s.getPageConfig("isOriginal")=="false"||!((i=s.getThemeConfig("post","post_original_copy",Boolean))!=null&&i.valueOf())||o.addEventListener("copy",t=>{t.preventDefault();const e=window.getSelection();if(!e)return;const n=e.toString();if(!n||n.length<30)return;const r=document.querySelector(".post-article");if(!r)return;const c=r.getAttribute("data-owner"),l=r.getAttribute("data-url"),a=r.getAttribute("data-siteName");let d=`
      ${s.translate("post.copyright_template_html.info","# 商业转载请联系作者获得授权，非商业转载请注明出处。<br>")}
      ${s.translate("post.copyright_template_html.license","# 协议(License): 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)<br>")}
      ${s.translate("post.copyright_template_html.author",`# 作者(Author): ${c} <br>`,{postAuthor:c})}
      ${s.translate("post.copyright_template_html.url",`# 链接(URL): ${l} <br>`,{postUrl:l})}
      ${s.translate("post.copyright_template_html.url",`# 来源(Source): ${a} <br>`,{siteName:a})}
      <br>
      `;const g=e.toString(),h=`${d}${g.replace(/\r\n/g,"<br>")}`,b=`${d.replace(/<br>/g,`
`)}${g.replace(/\r\n/g,`
`)}`;t.clipboardData&&(t.clipboardData.setData("text/html",h),t.clipboardData.setData("text/plain",b))}))}async registerShareWechat(){const o=document.getElementById("qrcode");if(!o)return;(await T(()=>import("../assets/browser-21db0a97.js").then(t=>t.b),[])).toCanvas(o,o.getAttribute("data-url"),{width:120,color:{dark:"#000000",light:"#ffffff"}})}registerWordCountToast(){var t,e;if(!((t=s.getThemeConfig("post","post_word_count_toast",Boolean))!=null&&t.valueOf()))return;const o=document.querySelector(".entry-content");if(!o)return;const i=y.getWordCount(o);if(i>0){const n=y.caclEstimateReadTime(i);let r="NORMAL";n<=60*10?r="NORMAL":n>60*10&&n<=60*30?r="MEDIUM":r="DIFFICULTY";let c="";const l=_.secondToTimeString(n);if(window.innerWidth>860){const a={normal:"文章篇幅适中，可以放心阅读。",medium:"文章比较长，建议分段阅读。",difficulty:"文章内容已经很陈旧了，也许不再适用！"};c=((e=s.getThemeConfig("post",`post_word_count_toast_${r.toLowerCase()}`,String))==null?void 0:e.valueOf())||s.translate("post.word_count_toast.remind",a[r.toLowerCase()],{context:r.toLowerCase()})}this.createPostToast(o,s.translate("post.word_count_toast.content",`文章共 <b>${i}</b> 字，阅读完预计需要 <b>${l}</b>。${c}`,{postWordCount:i,timeString:l,remind:c}),r,"word_count")}}registerEditTimeToast(){var l,a;const o=document.querySelector(".entry-content");if(!o||!((l=s.getThemeConfig("post","post_edit_time_toast",Boolean))!=null&&l.valueOf())||!s.getPageConfig("postLastModifyTime"))return;const i=s.getPageConfig("postLastModifyTime"),t=new Date(i),e=new Date().getTime()-t.getTime();let n="NORMAL";e<=1e3*60*60*24*30?n="NORMAL":e>1e3*60*60*24*30&&e<=1e3*60*60*24*90?n="MEDIUM":n="DIFFICULTY";let r="";if(window.innerWidth>860){const d={normal:"近期有所更新，请放心阅读！",medium:"文章内容已经有一段时间没有更新了，也许不再适用！",difficulty:"文章内容已经很陈旧了，也许不再适用！"};r=((a=s.getThemeConfig("post",`post_edit_time_toast_${n.toLowerCase()}`,String))==null?void 0:a.valueOf())||s.translate("post.edit_time_toast.remind",d[n.toLowerCase()],{context:n.toLowerCase()})}const c=_.RelativeTimeFormat(t.getTime());this.createPostToast(o,s.translate("post.edit_time_toast.content",`文章内容上次编辑时间于 <b>${c}</b>。${r}`,{sinceLastTime:c,remind:r}),n,"last_time")}createPostToast(o,i,t,e){const r=`<div class="${e} minicode" style="background-color: ${{NORMAL:"rgba(167, 210, 226, 1)",MEDIUM:"rgba(255, 197, 160, 1)",DIFFICULTY:"rgba(239, 206, 201, 1)"}[t]}">
      <span class="content-toast">
        ${i}
      </span>
      <div class="hide-minicode">
        <span class="iconify iconify--small" data-icon="fa:times"></span>
      </div>
    </div>`;if(o.querySelector(`.${e}`))return;const a=new DOMParser().parseFromString(r,"text/html").querySelector(`.${e}`);a.querySelector(".hide-minicode").addEventListener("click",()=>{a.classList.add("hide")},{once:!0}),o.insertAdjacentElement("afterbegin",a)}}p([m()],u.prototype,"autoCalculateSubmenuPosition",1);p([m()],u.prototype,"registerOriginalPostCopy",1);p([m()],u.prototype,"registerShareWechat",1);p([m()],u.prototype,"registerWordCountToast",1);p([m()],u.prototype,"registerEditTimeToast",1);
